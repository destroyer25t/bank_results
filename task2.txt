
ФУНКЦИЯ СТРОКА СТРОКАПРОВЕРИТЬВОЗМОЖНОСТЬ_ЛИМИТ(КЛИЕНТ, СУММА, ОПЕРАЦИЯ, КАНАЛ)
	ЕСЛИ СУММА НЕ РАВНА 0 ТОГДА
		МЕСЯЧНАЯСУММАКАНАЛ=*запрос из бд возвращающий сумму лимитов канала для клиента в текущем месяце*
		ЕСЛИ СУММА<МЕСЯЧНАЯСУММАКАНАЛ ИЛИ МЕСЯЧНАЯСУММАКАНАЛ==0 ТОГДА
			МЕСЯЧНАЯСУММАГРУППАОПЕРАЦИЙ=*запрос из бд возвращающий сумму лимитов группы операций которая содержит операцию для клиента в текущем месяце*
			ЕСЛИ СУММА<МЕСЯЧНАЯСУММАГРУППАОПЕРАЦИЙ ИЛИ МЕСЯЧНАЯСУММАГРУППАОПЕРАЦИЙ==0 ТОГДА
				МЕСЯЧНАЯСУММАОПЕРАЦИЯ=*запрос из бд возвращающий сумму лимитов операций для клиента в текущем месяце*
				ЕСЛИ СУММА<МЕСЯЧНАЯСУММАОПЕРАЦИЯ ИЛИ МЕСЯЧНАЯСУММАОПЕРАЦИЯ==0 ТОГДА
					ВЕРНУТЬ Y;
				КОН ЕСЛИ;
			КОН ЕСЛИ;
		КОН ЕСЛИ;
	КОН ЕСЛИ;	
	ВЕРНУТЬ N;
КОН ФУНКЦИЯ

Пояснения:
1.Без входной переменной КЛИЕНТ непонятно для чего вообще проверяется возможность лимита. Поэтому добавил.

2.При добавлении лимита клиенту, алгоритмом добавления должно проверяться поле ItsBank. Если лимит добавляется пользователем, то суммы ограничиваются существованием лимита такого же типа, но с переменной ItsBank=true. Если лимит добавляет банк, то производится проверка существования лимита такого же типа, но без переменной ItsBank=true; Если такой находится, то значения для лимита в LimitsValues обрезаются до значений установленных банком (если они выходят за границу значений установленных банком). Таким образом, при проверке возможности транзакции для клиента, ненужно дополнительно запрашивать установленный банком лимит - максимально возможный уже хранится в существующем, где ItsBank=false;

3.Подразумевается, что лимиты каналов настраиваются только банком. Если необходимо добавить возможность клиенту ограничивать еще и каналы - то в таблицу ChannelLimits добавляется поле ItsBank, а процедура добавления лимитов приводится к такому же виду как в пункте 2.


